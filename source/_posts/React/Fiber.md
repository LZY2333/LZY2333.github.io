---
title: Fiber
date: 2022-06-26 17:34:22
categories: 经验帖
tags: 
    - React
---

# Fiber

React16以前没有fiber

### Fiber解决了什么痛点？

在react15的时候，dom节点的渲染，是对虚拟节点遍历，创建节点，然后再递归遍历其子节点，创建子节点。

如果层级特别深，节点多，会导致JS任务执行太久，阻塞UI渲染线程，造成卡顿效果。

递归无法暂停的，且消耗性能。

### Fiber的执行时间片--帧

我们希望React的执行是可以暂停的，切分为无数个小任务分段执行，及时将进程让渡给UI渲染，

这个分段即为 帧,小任务即为 fiber数据结构

浏览器的渲染一般以 1000ms / 60帧 为单位，此时人眼不会感觉到卡顿，

换句话说 __在需要不断进行UI渲染的情况下，每一帧，每一段16.6ms，会进行一次 UI渲染__

而UI渲染完之后，这16.6ms会有剩余，

使用这个剩余时间进行JS的执行，并在下个帧开始前及时停止，就是fiber的实现原理。

### Fiber

Fiber 是一个执行单元，每次执行完一个执行单元，React就会检查还剩多少时间，如果没有时间把控制权交出去

Fiber 是一个数据结构，使用链表，将每一个 vdom 内部表示为一个fiber
