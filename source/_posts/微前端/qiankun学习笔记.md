---
title: qiankun学习笔记
date: 2022-09-14 23:24:22
categories: 技术栈
tags: 
    - 微前端
---

## qiankun学习笔记

### 微前端的优点

站在商业的角度,__微前端 最大的作用在于 确保一个项目的生命力__.

微前端架构,旧有项目能一直运行,若干年后能接入热门技术,随时能招到新人(Angular与react)

在技术的角度讲,微前端解决了现在前端存在的一个问题,那就是,

前端发展太快,并且百花齐放，如果web 技术栈能得到统一，所有library升级都做向下兼容，那么也没必要微前端

1. __技术栈无关__: 不限制接入应用的技术栈，微应用具备完全自主权

2. __独立开发、独立部署__: 微应用仓库独立，前后端可独立开发，部署完成后主框架自动完成同步更新

3. __增量升级__: 渐进式重构的重要策略，新老技术栈同时应用

4. __独立运行时__: 微应用之间相互独立,状态不共享

[qiankun介绍](https://qiankun.umijs.org/zh/guide)

### Why Not Iframe

iframe 优势是能完美解决 样式隔离、js 隔离, 劣势是 无法突破这些隔离.

__URL不同步__. 例如: 刷新丢失URL,无法 前进 后退

__UI不同步,DOM结构不共享,无法合并计算样式.__ 例如: iframe内弹出的弹出,要求 遮罩 居中 随浏览器Resize

__全局上下文完全隔离，内存变量不共享__ 例如: 无法 数据状态同步, iframe设置的cookie会被视为第三方cookie, 被浏览器禁止.

__慢__ 每次进入 都须 重新加载资源, 重建浏览器上下文

[Why Not Iframe](https://www.yuque.com/kuitos/gky7yw/gesexv)


### 公共逻辑抽离的 各种方式对比

[微前端模块共享你真的懂了吗](https://juejin.cn/post/6984682096291741704)


### single-spa



[从0实现一个前端微服务（上）](https://juejin.cn/post/6844904046822686733)

[微前端框架 之 qiankun 从入门到源码分析](https://juejin.cn/post/6885211340999229454)

[微前端框架 之 single-spa 从入门到精通](https://juejin.cn/post/6862661545592111111)

[你的 import 被 webpack 编译成了什么？](https://juejin.cn/post/6859569958742196237)


### 使用微前端方案需要注意什么

__技术栈无关 是 微前端框架 和 架构上的准绳，__

那么整个架构方案的实现上，都应该秉持这一原则，任何违背这一原则的做法都应该被摒弃。

__微应用之间不应该有任何直接或间接的技术栈、依赖、以及实现上的耦合。__

比如我们不能要求子应用、主应用必须使用某一版本的技术栈实现。

比如在通信机制的设计与选择上，尽量基于浏览器原生的 CustomEvent api，而不是自己搞的 pub/sub。

比如子应用是否具备不依赖宿主环境独立运行的能力，衡量标准是是否能一行代码不改，或者只改很少的配置，就能达成这一目标。

所以我认为正确的微前端方案的目标应该是：方案上跟使用 iframe 做微前端一样简单，同时又解决了 iframe 带来的各种体验上的问题。
